<!DOCTYPE html>
<html>
  <head>
      <script
      src="https://code.jquery.com/jquery-3.3.1.min.js"
      integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
      crossorigin="anonymous"></script>
    <meta charset="utf-8">
    <title>Heatmaps</title>
    <style>
      /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
      #map {
        height: 100%;
      }
      /* Optional: Makes the sample page fill the window. */
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
      #floating-panel {
        position: absolute;
        top: 10px;
        left: 38%;
        z-index: 5;
        background-color: #fff;
        padding: 5px;
        border: 1px solid #999;
        text-align: center;
        font-family: 'Roboto','sans-serif';
        line-height: 30px;
        padding-left: 10px;
      }
   
    </style>
  </head>

  <body>
    <div id="floating-panel">
      <button onclick="getTwoWeeksAgo()">Two Weeks Ago</button>
      <button onclick="getOneWeek()">One Week Ago</button>
      <button onclick="getToday()">Today</button>
      
    </div>
    <div id="map"></div>
    <script>

var map, heatmap;
    function getData(){
      markerArrayObjects=[]
      
          
        //  console.log(markerArrayObjects);
        }
//getData();
    var flag = false;

      function initMap() {
    $.get("/api/search", function(data) {
      markerArray=[];
     
        map = new google.maps.Map(document.getElementById('map'), {
          zoom: 11,
          center: {lat: 30.3254,  lng: -97.7195},
          mapTypeId: 'satellite'
        });

       
      
      
      
      
    });
  }
  function getTwoWeeksAgo() {
    markerArrayObjects=[]
    if(flag){
        heatmap.setMap(null)
       } 
        
      for (let i=0; i<5; i++){
        lat =  (Math.random() * (30.27 - 30.35) + 30.35).toFixed(4);
        longit =  (Math.random() * (-97.85 + 97.95) -97.95).toFixed(4);
           //console.log(lat, longit)
            let markerLatLng=new google.maps.LatLng(lat, longit);
          markerArrayObjects.push(markerLatLng)
          }
          for (let i=0; i<20; i++){
            lat =  (Math.random() * (30.4 - 30.45) + 30.45).toFixed(4);
            longit =  (Math.random() * (-97.85 + 97.95) -97.95).toFixed(4);
           //console.log(lat, longit)
            let markerLatLng=new google.maps.LatLng(lat, longit);
          markerArrayObjects.push(markerLatLng)
          }
          //30.4205° N, 97.9103° W
          for (let i=0; i<3; i++){
            lat =  (Math.random() * (30.2 - 30.5) + 30.5).toFixed(4);
            longit =  (Math.random() * (-97.5 + 97.8) -97.8).toFixed(4);
           //console.log(lat, longit)
            let markerLatLng=new google.maps.LatLng(lat, longit);
          
          markerArrayObjects.push(markerLatLng)
          }
          heatmap = new google.maps.visualization.HeatmapLayer({
          data: markerArrayObjects,
          map: map
        });
        flag = true;
      }

      function getOneWeek() {
        markerArrayObjects=[]
        heatmap.setMap(null)
      for (let i=0; i<30; i++){
        lat =  (Math.random() * (30.27 - 30.35) + 30.35).toFixed(4);
        longit =  (Math.random() * (-97.85 + 97.95) -97.95).toFixed(4);
           //console.log(lat, longit)
            let markerLatLng=new google.maps.LatLng(lat, longit);
          markerArrayObjects.push(markerLatLng)
          }
          for (let i=0; i<30; i++){
            lat =  (Math.random() * (30.4 - 30.45) + 30.45).toFixed(4);
            longit =  (Math.random() * (-97.85 + 97.95) -97.95).toFixed(4);
           //console.log(lat, longit)
            let markerLatLng=new google.maps.LatLng(lat, longit);
          markerArrayObjects.push(markerLatLng)
          }
          //30.4205° N, 97.9103° W
          for (let i=0; i<20; i++){
            lat =  (Math.random() * (30.2 - 30.5) + 30.5).toFixed(4);
            longit =  (Math.random() * (-97.5 + 97.8) -97.8).toFixed(4);
           //console.log(lat, longit)
            let markerLatLng=new google.maps.LatLng(lat, longit);
          
          markerArrayObjects.push(markerLatLng)
          }
          heatmap = new google.maps.visualization.HeatmapLayer({
          data: markerArrayObjects,
          map: map
        });
      }
      

      function getToday() {
        markerArrayObjects=[]
       if(flag){
        heatmap.setMap(null)
       } 
      for (let i=0; i<95; i++){
        lat =  (Math.random() * (30.27 - 30.35) + 30.35).toFixed(4);
        longit =  (Math.random() * (-97.85 + 97.95) -97.95).toFixed(4);
           //console.log(lat, longit)
            let markerLatLng=new google.maps.LatLng(lat, longit);
          markerArrayObjects.push(markerLatLng)
          }
          for (let i=0; i<50; i++){
            lat =  (Math.random() * (30.4 - 30.45) + 30.45).toFixed(4);
            longit =  (Math.random() * (-97.85 + 97.95) -97.95).toFixed(4);
           //console.log(lat, longit)
            let markerLatLng=new google.maps.LatLng(lat, longit);
          markerArrayObjects.push(markerLatLng)
          }
          //30.4205° N, 97.9103° W
          for (let i=0; i<30; i++){
            lat =  (Math.random() * (30.2 - 30.5) + 30.5).toFixed(4);
            longit =  (Math.random() * (-97.5 + 97.8) -97.8).toFixed(4);
           //console.log(lat, longit)
            let markerLatLng=new google.maps.LatLng(lat, longit);
          markerArrayObjects.push(markerLatLng)
          }
          heatmap = new google.maps.visualization.HeatmapLayer({
          data: markerArrayObjects,
          map: map
        });
        flag = true;
        console.log(heatmap)
          
      }

      function changeOpacity() {
        heatmap.set('opacity', heatmap.get('opacity') ? null : 0.2);
      }
        
      
    </script>
    <script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCYQHKMzQBNqWcLUvLKJNrSdXqZ90wOA88&libraries=visualization&callback=initMap">
    </script>
  </body>
</html>